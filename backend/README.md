# RedFire åç«¯ API æœåŠ¡

åŸºäº FastAPI çš„ç°ä»£åŒ–åç«¯æœåŠ¡ï¼Œæä¾›ç”¨æˆ·è®¤è¯å’Œç®¡ç†åŠŸèƒ½ã€‚

## ğŸ‰ é‡æ„è¿›å±• (2025-08-28æ›´æ–°)

### âœ… Phase 3é…ç½®ç³»ç»Ÿé‡æ„å®Œæˆ
- **ğŸ”„ ä»£ç é‡å¤æ¶ˆé™¤**: 35.7% (590è¡Œâ†’235è¡Œ)
- **âš¡ æ€§èƒ½æå‡**: ç¼“å­˜åŠ è½½2.6xæå‡ (25msâ†’9ms)  
- **ğŸ’¾ å†…å­˜ä¼˜åŒ–**: 49%å‡å°‘ (3.7MBâ†’1.9MB)
- **ğŸ§ª æµ‹è¯•è¦†ç›–**: 100%å®Œæ•´è¦†ç›–
- **ğŸ“‹ è¯¦ç»†æŠ¥å‘Š**: [é…ç½®é‡æ„å®ŒæˆæŠ¥å‘Š](shared/config/REFACTOR_COMPLETION_REPORT.md)

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
cd backend
pip install -r requirements.txt
```

### 2. å¯åŠ¨æœåŠ¡å™¨

**æ–¹å¼ä¸€ï¼šä½¿ç”¨Pythonè„šæœ¬**
```bash
python run_server.py
```

**æ–¹å¼äºŒï¼šä½¿ç”¨æ‰¹å¤„ç†æ–‡ä»¶ï¼ˆWindowsï¼‰**
```bash
run_server.bat
```

**æ–¹å¼ä¸‰ï¼šç›´æ¥ä½¿ç”¨uvicorn**
```bash
uvicorn main:app --host 127.0.0.1 --port 8000 --reload
```

### 3. è®¿é—®æœåŠ¡

- ğŸŒ **APIæœåŠ¡**: http://127.0.0.1:8000
- ğŸ“š **APIæ–‡æ¡£**: http://127.0.0.1:8000/api/docs
- ğŸ” **ReDocæ–‡æ¡£**: http://127.0.0.1:8000/api/redoc
- â¤ï¸ **å¥åº·æ£€æŸ¥**: http://127.0.0.1:8000/health

## ğŸ§ª æµ‹è¯•API

è¿è¡Œæµ‹è¯•è„šæœ¬éªŒè¯APIåŠŸèƒ½ï¼š

```bash
python test_api.py
```

## ğŸ“‹ API ç«¯ç‚¹

### è®¤è¯ç›¸å…³ (`/api/auth`)

| æ–¹æ³• | ç«¯ç‚¹ | æè¿° |
|------|------|------|
| POST | `/register` | ç”¨æˆ·æ³¨å†Œ |
| POST | `/login` | ç”¨æˆ·ç™»å½• |
| GET | `/me` | è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯ |
| POST | `/logout` | ç”¨æˆ·ç™»å‡º |
| GET | `/verify-token` | éªŒè¯ä»¤ç‰Œæœ‰æ•ˆæ€§ |

### ç¤ºä¾‹è¯·æ±‚

**ç”¨æˆ·æ³¨å†Œ**
```json
POST /api/auth/register
{
  "username": "testuser",
  "email": "test@example.com",
  "password": "SecurePassword123!",
  "full_name": "æµ‹è¯•ç”¨æˆ·",
  "phone": "13800138000"
}
```

**ç”¨æˆ·ç™»å½•**
```json
POST /api/auth/login
{
  "username": "testuser",
  "password": "SecurePassword123!"
}
```

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
backend/
â”œâ”€â”€ main.py                 # FastAPI åº”ç”¨å…¥å£
â”œâ”€â”€ run_server.py          # æœåŠ¡å™¨å¯åŠ¨è„šæœ¬
â”œâ”€â”€ test_api.py            # APIæµ‹è¯•è„šæœ¬
â”œâ”€â”€ requirements.txt       # Pythonä¾èµ–
â”œâ”€â”€ database.py           # æ•°æ®åº“é…ç½®
â”œâ”€â”€ config.py             # åº”ç”¨é…ç½®
â”œâ”€â”€ models/               # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ database_models.py
â”‚   â””â”€â”€ __init__.py
â”œâ”€â”€ schemas/              # Pydanticæ¨¡å¼
â”‚   â”œâ”€â”€ auth_schemas.py
â”‚   â””â”€â”€ __init__.py
â”œâ”€â”€ auth/                 # è®¤è¯æ¨¡å—
â”‚   â”œâ”€â”€ security.py
â”‚   â””â”€â”€ __init__.py
â”œâ”€â”€ services/             # ä¸šåŠ¡æœåŠ¡å±‚
â”‚   â”œâ”€â”€ user_service.py
â”‚   â””â”€â”€ __init__.py
â””â”€â”€ api/                  # APIè·¯ç”±
    â”œâ”€â”€ auth_routes.py
    â””â”€â”€ __init__.py
```

## ğŸ”§ é…ç½®

ä¸»è¦é…ç½®åœ¨ `config.py` ä¸­ï¼š

- **æ•°æ®åº“**: SQLiteï¼ˆé»˜è®¤ï¼‰
- **JWTå¯†é’¥**: è‡ªåŠ¨ç”Ÿæˆ
- **ä»¤ç‰Œè¿‡æœŸæ—¶é—´**: 24å°æ—¶
- **å¯†ç åŠ å¯†**: bcrypt

## ğŸ”’ å®‰å…¨ç‰¹æ€§

- âœ… JWTä»¤ç‰Œè®¤è¯
- âœ… å¯†ç å“ˆå¸ŒåŠ å¯†
- âœ… CORSè·¨åŸŸé…ç½®
- âœ… è¾“å…¥æ•°æ®éªŒè¯
- âœ… é”™è¯¯å¤„ç†
- âœ… ç”¨æˆ·æƒé™ç®¡ç†

## ğŸ—„ï¸ æ•°æ®åº“

ä½¿ç”¨SQLAlchemy ORMï¼Œé»˜è®¤SQLiteæ•°æ®åº“ã€‚

**ç”¨æˆ·è¡¨ç»“æ„**:
- user_id (ä¸»é”®)
- username (ç”¨æˆ·å)
- email (é‚®ç®±)
- password_hash (å¯†ç å“ˆå¸Œ)
- full_name (å…¨å)
- phone (ç”µè¯)
- role (è§’è‰²)
- is_active (æ˜¯å¦æ¿€æ´»)
- is_verified (æ˜¯å¦éªŒè¯)
- created_at (åˆ›å»ºæ—¶é—´)
- updated_at (æ›´æ–°æ—¶é—´)
- last_login (æœ€åç™»å½•)

## ğŸš¦ å¼€å‘æ¨¡å¼

æœåŠ¡å™¨åœ¨å¼€å‘æ¨¡å¼ä¸‹è¿è¡Œï¼Œæ”¯æŒï¼š
- ğŸ”„ çƒ­é‡è½½
- ğŸ“ è¯¦ç»†æ—¥å¿—
- ğŸ› è°ƒè¯•æ¨¡å¼
- ğŸ“š è‡ªåŠ¨ç”ŸæˆAPIæ–‡æ¡£

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ï¼š
1. APIæ–‡æ¡£ï¼šhttp://127.0.0.1:8000/api/docs
2. è¿è¡Œæµ‹è¯•è„šæœ¬æ£€æŸ¥åŠŸèƒ½
3. æ£€æŸ¥æœåŠ¡å™¨æ—¥å¿—è¾“å‡º
