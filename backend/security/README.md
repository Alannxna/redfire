# ğŸ›¡ï¸ RedFire ä¼ä¸šçº§å®‰å…¨é˜²æŠ¤ç³»ç»Ÿ

## ğŸš€ æ¦‚è¿°

RedFireå®‰å…¨é˜²æŠ¤ç³»ç»Ÿæ˜¯ä¸€ä¸ªå…¨é¢çš„ä¼ä¸šçº§Webåº”ç”¨å®‰å…¨è§£å†³æ–¹æ¡ˆï¼ŒåŸºäºTODO-15çš„è¦æ±‚è®¾è®¡å’Œå®ç°ã€‚è¯¥ç³»ç»Ÿæä¾›äº†å¤šå±‚çº§çš„å®‰å…¨é˜²æŠ¤ï¼ŒåŒ…æ‹¬Webåº”ç”¨é˜²ç«å¢™ã€æ™ºèƒ½é™æµã€å®æ—¶ç›‘æ§ã€å¨èƒæ£€æµ‹å’Œå‘Šè­¦ç­‰åŠŸèƒ½ã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸ›¡ï¸ Webåº”ç”¨é˜²ç«å¢™ (WAF)
- **SQLæ³¨å…¥é˜²æŠ¤**: å¤šå±‚æ¨¡å¼æ£€æµ‹ï¼Œæ”¯æŒé«˜ã€ä¸­ã€ä½æ•æ„Ÿåº¦è®¾ç½®
- **XSSæ”»å‡»é˜²æŠ¤**: å…¨é¢çš„è·¨ç«™è„šæœ¬æ”»å‡»æ£€æµ‹å’Œé˜»æ–­
- **CSRFé˜²æŠ¤**: ä»¤ç‰ŒéªŒè¯æœºåˆ¶ï¼Œé˜²æ­¢è·¨ç«™è¯·æ±‚ä¼ªé€ 
- **è·¯å¾„éå†é˜²æŠ¤**: é˜²æ­¢ç›®å½•éå†å’Œæ–‡ä»¶è®¿é—®æ”»å‡»
- **å‘½ä»¤æ³¨å…¥é˜²æŠ¤**: æ£€æµ‹å’Œé˜»æ–­ç³»ç»Ÿå‘½ä»¤æ³¨å…¥å°è¯•
- **æ–‡ä»¶ä¸Šä¼ å®‰å…¨**: æ–‡ä»¶ç±»å‹æ£€æŸ¥ã€å¤§å°é™åˆ¶ã€æ¶æ„æ–‡ä»¶æ‰«æ

### ğŸš¦ æ™ºèƒ½é™æµç³»ç»Ÿ
- **å¤šç§ç®—æ³•æ”¯æŒ**: ä»¤ç‰Œæ¡¶ã€æ»‘åŠ¨çª—å£ã€å›ºå®šçª—å£ã€è‡ªé€‚åº”ç®—æ³•
- **å¤šç»´åº¦é™æµ**: å…¨å±€ã€IPã€ç”¨æˆ·ã€ç«¯ç‚¹çº§åˆ«çš„ç²¾ç»†åŒ–é™æµ
- **åˆ†å¸ƒå¼é™æµ**: Redisæ”¯æŒçš„åˆ†å¸ƒå¼é™æµæœºåˆ¶
- **DDoSé˜²æŠ¤**: æ™ºèƒ½DDoSæ£€æµ‹å’Œè‡ªåŠ¨IPé»‘åå•
- **åŠ¨æ€è°ƒæ•´**: åŸºäºç³»ç»Ÿè´Ÿè½½çš„è‡ªé€‚åº”é™æµç­–ç•¥

### ğŸ“Š å®‰å…¨ç›‘æ§ç³»ç»Ÿ
- **å®æ—¶äº‹ä»¶ç›‘æ§**: å…¨é¢çš„å®‰å…¨äº‹ä»¶æ”¶é›†å’Œåˆ†æ
- **å¼‚å¸¸æ£€æµ‹**: åŸºäºæœºå™¨å­¦ä¹ çš„å¼‚å¸¸è¡Œä¸ºæ£€æµ‹
- **å¨èƒæƒ…æŠ¥é›†æˆ**: æ¶æ„IPã€åŸŸåã€å¨èƒç­¾åæ•°æ®åº“
- **å®‰å…¨æŒ‡æ ‡ç»Ÿè®¡**: å®æ—¶å®‰å…¨æŒ‡æ ‡è®¡ç®—å’Œè¶‹åŠ¿åˆ†æ
- **å®¡è®¡æ—¥å¿—**: å®Œæ•´çš„å®‰å…¨æ“ä½œå®¡è®¡è®°å½•

### ğŸš¨ æ™ºèƒ½å‘Šè­¦ç³»ç»Ÿ
- **å¤šæ¸ é“é€šçŸ¥**: é‚®ä»¶ã€Webhookã€çŸ­ä¿¡ã€æ—¥å¿—ç­‰å¤šç§å‘Šè­¦æ–¹å¼
- **æ™ºèƒ½èšåˆ**: ç›¸å…³äº‹ä»¶çš„æ™ºèƒ½èšåˆå’Œå»é‡
- **ä¸¥é‡ç¨‹åº¦åˆ†çº§**: åŸºäºå¨èƒçº§åˆ«çš„è‡ªåŠ¨å‘Šè­¦ç­–ç•¥
- **å‘Šè­¦ç®¡ç†**: å‘Šè­¦ç¡®è®¤ã€è§£å†³ã€çŠ¶æ€è·Ÿè¸ª

### ğŸ” å®‰å…¨é…ç½®ç®¡ç†
- **å¤šç¯å¢ƒé…ç½®**: å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒçš„å·®å¼‚åŒ–é…ç½®
- **å®‰å…¨ç­–ç•¥**: çµæ´»çš„å®‰å…¨ç­–ç•¥é…ç½®å’ŒéªŒè¯
- **å¯†é’¥ç®¡ç†**: å®‰å…¨çš„å¯†é’¥ç”Ÿæˆã€è½®æ¢å’Œç®¡ç†
- **é…ç½®çƒ­æ›´æ–°**: æ”¯æŒé…ç½®çš„åŠ¨æ€æ›´æ–°å’ŒéªŒè¯

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```mermaid
graph TB
    subgraph "å®¢æˆ·ç«¯è¯·æ±‚"
        A[HTTPè¯·æ±‚]
    end
    
    subgraph "å®‰å…¨é˜²æŠ¤å±‚"
        B[å®‰å…¨ä¸­é—´ä»¶]
        C[WAFå¼•æ“]
        D[é™æµå™¨]
        E[CSRFé˜²æŠ¤]
        F[å®‰å…¨å“åº”å¤´]
    end
    
    subgraph "ç›‘æ§åˆ†æå±‚"
        G[å®‰å…¨ç›‘æ§å™¨]
        H[å¼‚å¸¸æ£€æµ‹å™¨]
        I[å¨èƒæƒ…æŠ¥]
        J[äº‹ä»¶åˆ†æå™¨]
    end
    
    subgraph "å‘Šè­¦å“åº”å±‚"
        K[å‘Šè­¦ç®¡ç†å™¨]
        L[é€šçŸ¥å¼•æ“]
        M[äº‹ä»¶å­˜å‚¨]
    end
    
    subgraph "åç«¯åº”ç”¨"
        N[FastAPIåº”ç”¨]
    end
    
    A --> B
    B --> C
    C --> D
    D --> E
    E --> F
    F --> N
    
    B --> G
    G --> H
    G --> I
    H --> J
    I --> J
    J --> K
    K --> L
    J --> M
```

## ğŸ“¦ æ ¸å¿ƒç»„ä»¶

### 1. SecurityConfigManager
```python
from backend.security import SecurityConfigManager, security_config

# ä½¿ç”¨å…¨å±€é…ç½®
config = security_config

# æˆ–åˆ›å»ºè‡ªå®šä¹‰é…ç½®
custom_config = SecurityConfigManager(environment="production")
```

### 2. SecurityMiddleware
```python
from backend.security import SecurityMiddleware, create_security_middleware

# åˆ›å»ºå®‰å…¨ä¸­é—´ä»¶
middleware = create_security_middleware(config)

# æ·»åŠ åˆ°FastAPIåº”ç”¨
app.add_middleware(SecurityMiddleware, config=config)
```

### 3. SmartRateLimiter
```python
from backend.security import SmartRateLimiter

# åˆ›å»ºæ™ºèƒ½é™æµå™¨
rate_limiter = SmartRateLimiter(config)

# æ£€æŸ¥é™æµ
result = await rate_limiter.check_rate_limit(request, user_id)
```

### 4. SecurityMonitor
```python
from backend.security import SecurityMonitor, SecurityEvent, EventType

# åˆ›å»ºå®‰å…¨ç›‘æ§å™¨
monitor = SecurityMonitor(config)

# è®°å½•å®‰å…¨äº‹ä»¶
event = SecurityEvent(...)
await monitor.record_event(event)
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ä¸€é”®é›†æˆ
```python
from fastapi import FastAPI
from backend.security import setup_security

# åˆ›å»ºFastAPIåº”ç”¨
app = FastAPI()

# ä¸€é”®é›†æˆå®‰å…¨é˜²æŠ¤
security = setup_security(app)

# ç°åœ¨ä½ çš„åº”ç”¨å·²ç»å…·å¤‡å®Œæ•´çš„å®‰å…¨é˜²æŠ¤åŠŸèƒ½
```

### 2. è‡ªå®šä¹‰é…ç½®
```python
from backend.security import SecurityConfigManager, setup_security

# åˆ›å»ºè‡ªå®šä¹‰é…ç½®
config = SecurityConfigManager(environment="production")

# ä¿®æ”¹é…ç½®
config.waf.sql_injection_protection = True
config.rate_limit.global_requests_per_minute = 1000

# ä½¿ç”¨è‡ªå®šä¹‰é…ç½®
security = setup_security(app, config)
```

### 3. æ‰‹åŠ¨è®°å½•å®‰å…¨äº‹ä»¶
```python
from backend.security import EventType, SecurityLevel

@app.post("/sensitive-operation")
async def sensitive_operation(request: Request):
    # æ‰§è¡Œæ•æ„Ÿæ“ä½œ
    try:
        result = perform_operation()
        
        # è®°å½•æˆåŠŸäº‹ä»¶
        await security.record_security_event(
            event_type=EventType.PRIVILEGE_ESCALATION,
            request=request,
            severity=SecurityLevel.MEDIUM,
            description="æ•æ„Ÿæ“ä½œæ‰§è¡ŒæˆåŠŸ"
        )
        
        return result
        
    except Exception as e:
        # è®°å½•å¤±è´¥äº‹ä»¶
        await security.record_security_event(
            event_type=EventType.SYSTEM_COMPROMISE,
            request=request,
            severity=SecurityLevel.HIGH,
            description=f"æ•æ„Ÿæ“ä½œå¤±è´¥: {str(e)}",
            blocked=True
        )
        raise
```

### 4. ä½¿ç”¨è£…é¥°å™¨
```python
from backend.security import log_security_event, EventType, SecurityLevel

@app.get("/admin/users")
@log_security_event(EventType.AUTHORIZATION_FAILURE, SecurityLevel.MEDIUM, "è®¿é—®ç”¨æˆ·ç®¡ç†")
async def admin_users(request: Request):
    return {"users": []}
```

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡é…ç½®
```bash
# åŸºç¡€é…ç½®
ENVIRONMENT=production
JWT_SECRET_KEY=your-strong-secret-key
ENCRYPTION_KEY=your-encryption-key

# Redisé…ç½®
REDIS_HOST=localhost
REDIS_PORT=6379

# é‚®ä»¶å‘Šè­¦é…ç½®
SMTP_SERVER=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-app-password
ALERT_EMAIL=admin@yourcompany.com

# Webhookå‘Šè­¦é…ç½®
ALERT_WEBHOOK_URL=https://your-webhook-url.com/alerts
```

### ç”Ÿäº§ç¯å¢ƒæœ€ä½³å®è·µ
```python
# ç”Ÿäº§ç¯å¢ƒå®‰å…¨é…ç½®ç¤ºä¾‹
config = SecurityConfigManager(environment="production")

# WAFé…ç½®
config.waf.protection_mode = ProtectionMode.BLOCK
config.waf.sql_injection_sensitivity = SecurityLevel.HIGH
config.waf.xss_sensitivity = SecurityLevel.HIGH

# é™æµé…ç½®
config.rate_limit.global_requests_per_minute = 1000
config.rate_limit.ip_requests_per_minute = 100
config.rate_limit.distributed_mode = True

# ç›‘æ§é…ç½®
config.monitoring.real_time_monitoring = True
config.monitoring.alert_enabled = True
config.monitoring.audit_enabled = True

# å®‰å…¨å“åº”å¤´
config.headers.strict_transport_security = True
config.headers.content_security_policy = True
```

## ğŸ“Š APIæ¥å£

### å®‰å…¨çŠ¶æ€æ¥å£
```http
GET /api/security/status
```
è·å–å®‰å…¨ç³»ç»Ÿæ•´ä½“çŠ¶æ€

### CSRFä»¤ç‰Œæ¥å£
```http
GET /api/security/csrf-token
Authorization: Bearer <your-token>
```
è·å–CSRFé˜²æŠ¤ä»¤ç‰Œ

### é™æµçŠ¶æ€æ¥å£
```http
GET /api/security/rate-limits
```
è·å–å½“å‰ç”¨æˆ·çš„é™æµçŠ¶æ€

### å®‰å…¨å‘Šè­¦æ¥å£
```http
GET /api/security/alerts
POST /api/security/alerts/{alert_id}/acknowledge
POST /api/security/alerts/{alert_id}/resolve
```
ç®¡ç†å®‰å…¨å‘Šè­¦

### å®‰å…¨äº‹ä»¶æŠ¥å‘Šæ¥å£
```http
POST /api/security/report-incident
Content-Type: application/json

{
    "description": "å‘ç°å¯ç–‘æ´»åŠ¨",
    "severity": "MEDIUM",
    "details": {...}
}
```

## ğŸ” ç›‘æ§æŒ‡æ ‡

### æ ¸å¿ƒå®‰å…¨æŒ‡æ ‡
- **æ€»äº‹ä»¶æ•°**: å½“æ—¥å®‰å…¨äº‹ä»¶æ€»æ•°
- **å¨èƒåˆ†æ•°**: åŸºäºäº‹ä»¶ä¸¥é‡ç¨‹åº¦çš„å¨èƒè¯„åˆ†
- **æ”»å‡»ç±»å‹åˆ†å¸ƒ**: å„ç±»æ”»å‡»çš„åˆ†å¸ƒç»Ÿè®¡
- **é˜»æ–­ç‡**: æˆåŠŸé˜»æ–­çš„æ”»å‡»æ¯”ä¾‹
- **å“åº”æ—¶é—´**: å®‰å…¨æ£€æŸ¥çš„å¹³å‡å“åº”æ—¶é—´

### é™æµæŒ‡æ ‡
- **è¯·æ±‚é€šè¿‡ç‡**: æˆåŠŸé€šè¿‡é™æµæ£€æŸ¥çš„è¯·æ±‚æ¯”ä¾‹
- **é™æµè§¦å‘æ¬¡æ•°**: å„çº§åˆ«é™æµçš„è§¦å‘ç»Ÿè®¡
- **çƒ­ç‚¹IP**: è¯·æ±‚é¢‘ç‡æœ€é«˜çš„IPåœ°å€
- **çƒ­ç‚¹ç«¯ç‚¹**: è®¿é—®é¢‘ç‡æœ€é«˜çš„APIç«¯ç‚¹

### å¼‚å¸¸æ£€æµ‹æŒ‡æ ‡
- **å¼‚å¸¸ç™»å½•**: å¼‚å¸¸æ—¶é—´ã€åœ°ç‚¹çš„ç™»å½•å°è¯•
- **è¡Œä¸ºå¼‚å¸¸**: å¼‚å¸¸çš„ç”¨æˆ·è¡Œä¸ºæ¨¡å¼
- **é¢‘ç‡å¼‚å¸¸**: å¼‚å¸¸çš„è¯·æ±‚é¢‘ç‡æ¨¡å¼
- **åœ°ç†å¼‚å¸¸**: å¼‚å¸¸çš„åœ°ç†ä½ç½®è®¿é—®

## ğŸš¨ å‘Šè­¦é…ç½®

### é‚®ä»¶å‘Šè­¦
```python
# é…ç½®SMTPè®¾ç½®
import os
os.environ["SMTP_SERVER"] = "smtp.gmail.com"
os.environ["SMTP_PORT"] = "587"
os.environ["SMTP_USERNAME"] = "alerts@yourcompany.com"
os.environ["SMTP_PASSWORD"] = "your-app-password"
os.environ["ALERT_EMAIL"] = "security-team@yourcompany.com"
```

### Webhookå‘Šè­¦
```python
# é…ç½®Webhook URL
os.environ["ALERT_WEBHOOK_URL"] = "https://hooks.slack.com/services/..."

# Webhookæ•°æ®æ ¼å¼
{
    "alert_id": "alert_1234567890",
    "title": "SQLæ³¨å…¥æ”»å‡»æ£€æµ‹",
    "severity": "HIGH",
    "created_at": "2024-01-15T10:30:00Z",
    "events": [...]
}
```

### å‘Šè­¦è§„åˆ™
- **ä¸¥é‡ç¨‹åº¦é˜ˆå€¼**: åªæœ‰è¾¾åˆ°é…ç½®é˜ˆå€¼çš„å‘Šè­¦æ‰ä¼šå‘é€
- **äº‹ä»¶èšåˆ**: ç›¸å…³äº‹ä»¶è‡ªåŠ¨èšåˆä¸ºå•ä¸ªå‘Šè­¦
- **é¢‘ç‡æ§åˆ¶**: é˜²æ­¢å‘Šè­¦è½°ç‚¸çš„é¢‘ç‡æ§åˆ¶æœºåˆ¶
- **å‘Šè­¦å‡çº§**: æœªå¤„ç†å‘Šè­¦çš„è‡ªåŠ¨å‡çº§æœºåˆ¶

## ğŸ§ª æµ‹è¯•å’ŒéªŒè¯

### å®‰å…¨æµ‹è¯•
```python
# æµ‹è¯•SQLæ³¨å…¥é˜²æŠ¤
import requests

# è¿™ä¸ªè¯·æ±‚åº”è¯¥è¢«é˜»æ–­
response = requests.get("http://localhost:8000/api/users?id=1' OR '1'='1")
assert response.status_code == 403

# æµ‹è¯•XSSé˜²æŠ¤
response = requests.post(
    "http://localhost:8000/api/comments",
    json={"content": "<script>alert('xss')</script>"}
)
assert response.status_code == 403
```

### é™æµæµ‹è¯•
```python
import asyncio
import aiohttp

async def test_rate_limit():
    async with aiohttp.ClientSession() as session:
        tasks = []
        for i in range(150):  # è¶…è¿‡é™åˆ¶çš„è¯·æ±‚æ•°
            task = session.get("http://localhost:8000/api/test")
            tasks.append(task)
        
        responses = await asyncio.gather(*tasks, return_exceptions=True)
        
        # æ£€æŸ¥æ˜¯å¦æœ‰429çŠ¶æ€ç 
        rate_limited = [r for r in responses if hasattr(r, 'status') and r.status == 429]
        assert len(rate_limited) > 0
```

### ç›‘æ§æµ‹è¯•
```python
from backend.security import SecurityMonitor, SecurityEvent, EventType

# æµ‹è¯•äº‹ä»¶è®°å½•
monitor = SecurityMonitor(config)
event = SecurityEvent(
    event_type=EventType.SQL_INJECTION,
    # ... å…¶ä»–å­—æ®µ
)

await monitor.record_event(event)

# æ£€æŸ¥ä»ªè¡¨æ¿æ•°æ®
dashboard = await monitor.get_security_dashboard()
assert "metrics" in dashboard
```

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **Redisè¿æ¥å¤±è´¥**
   ```
   è­¦å‘Š: Redisè¿æ¥å¤±è´¥ï¼Œä½¿ç”¨å†…å­˜å­˜å‚¨
   ```
   - æ£€æŸ¥RedisæœåŠ¡æ˜¯å¦è¿è¡Œ
   - ç¡®è®¤Redisè¿æ¥é…ç½®æ­£ç¡®
   - éªŒè¯ç½‘ç»œè¿æ¥

2. **é‚®ä»¶å‘Šè­¦å¤±è´¥**
   ```
   é”™è¯¯: å‘é€é‚®ä»¶å‘Šè­¦å¤±è´¥
   ```
   - æ£€æŸ¥SMTPé…ç½®æ˜¯å¦æ­£ç¡®
   - ç¡®è®¤é‚®ç®±å¯†ç æˆ–åº”ç”¨å¯†ç 
   - éªŒè¯SMTPæœåŠ¡å™¨è®¾ç½®

3. **é™æµè¯¯åˆ¤**
   ```
   è­¦å‘Š: æ­£å¸¸è¯·æ±‚è¢«é™æµé˜»æ–­
   ```
   - æ£€æŸ¥é™æµé˜ˆå€¼è®¾ç½®
   - ç¡®è®¤IPè·å–é€»è¾‘æ­£ç¡®
   - è°ƒæ•´é™æµç®—æ³•å‚æ•°

4. **å®‰å…¨æ£€æŸ¥æ€§èƒ½é—®é¢˜**
   ```
   è­¦å‘Š: å®‰å…¨æ£€æŸ¥å“åº”æ—¶é—´è¿‡é•¿
   ```
   - ä¼˜åŒ–æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼
   - å¯ç”¨Redisç¼“å­˜
   - è°ƒæ•´æ£€æŸ¥æ·±åº¦

### æ—¥å¿—åˆ†æ
```python
import logging

# è®¾ç½®è¯¦ç»†æ—¥å¿—
logging.basicConfig(level=logging.DEBUG)

# æŸ¥çœ‹å®‰å…¨ç³»ç»Ÿæ—¥å¿—
logger = logging.getLogger("backend.security")
logger.setLevel(logging.DEBUG)

# å…³é”®æ—¥å¿—ä½ç½®
# - å®‰å…¨äº‹ä»¶: backend.security.security_monitor
# - WAFæ£€æµ‹: backend.security.security_middleware  
# - é™æµå†³ç­–: backend.security.rate_limiter
# - å‘Šè­¦å‘é€: backend.security.security_monitor
```

### æ€§èƒ½ä¼˜åŒ–

1. **å¯ç”¨Redisç¼“å­˜**
   ```python
   # ç¡®ä¿Redisé…ç½®æ­£ç¡®
   config.rate_limit.distributed_mode = True
   ```

2. **è°ƒæ•´æ£€æŸ¥æ·±åº¦**
   ```python
   # å‡å°‘æ­£åˆ™æ£€æŸ¥æ•°é‡
   config.waf.sql_injection_sensitivity = SecurityLevel.MEDIUM
   ```

3. **ä¼˜åŒ–å‘Šè­¦é¢‘ç‡**
   ```python
   # æé«˜å‘Šè­¦é˜ˆå€¼
   config.monitoring.alert_severity_threshold = SecurityLevel.HIGH
   ```

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

### åŸºå‡†æ€§èƒ½
- **å®‰å…¨æ£€æŸ¥å»¶è¿Ÿ**: < 10ms (å¹³å‡)
- **é™æµæ£€æŸ¥å»¶è¿Ÿ**: < 5ms (å¹³å‡)
- **å†…å­˜ä½¿ç”¨**: < 100MB (åŸºç¡€)
- **CPUä½¿ç”¨**: < 5% (æ­£å¸¸è´Ÿè½½)

### æ‰©å±•æ€§
- **å¹¶å‘å¤„ç†**: 1000+ å¹¶å‘è¯·æ±‚
- **äº‹ä»¶å¤„ç†**: 10000+ äº‹ä»¶/åˆ†é’Ÿ
- **å‘Šè­¦å“åº”**: < 30ç§’
- **å­˜å‚¨å®¹é‡**: æ”¯æŒTBçº§äº‹ä»¶å­˜å‚¨

## ğŸ› ï¸ æ‰©å±•å¼€å‘

### è‡ªå®šä¹‰å®‰å…¨è§„åˆ™
```python
class CustomWAFRule:
    def __init__(self):
        self.pattern = re.compile(r"custom_threat_pattern")
    
    def check(self, request_data: str) -> bool:
        return bool(self.pattern.search(request_data))

# æ³¨å†Œè‡ªå®šä¹‰è§„åˆ™
waf_engine.add_custom_rule(CustomWAFRule())
```

### è‡ªå®šä¹‰å‘Šè­¦æ¸ é“
```python
class CustomAlertHandler:
    async def send_alert(self, alert: SecurityAlert):
        # å®ç°è‡ªå®šä¹‰å‘Šè­¦é€»è¾‘
        pass

# æ³¨å†Œè‡ªå®šä¹‰å‘Šè­¦å¤„ç†å™¨
alert_manager.register_handler(AlertChannel.CUSTOM, CustomAlertHandler())
```

### å¨èƒæƒ…æŠ¥é›†æˆ
```python
class CustomThreatIntelligence:
    async def update_threat_data(self):
        # ä»å¤–éƒ¨APIè·å–å¨èƒæ•°æ®
        pass
    
    def is_malicious(self, indicator: str) -> bool:
        # æ£€æŸ¥å¨èƒæŒ‡æ ‡
        pass

# é›†æˆè‡ªå®šä¹‰å¨èƒæƒ…æŠ¥
threat_intel.add_source(CustomThreatIntelligence())
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å®‰å…¨é…ç½®å‚è€ƒ](./security_config.py)
- [ä¸­é—´ä»¶å¼€å‘æŒ‡å—](./security_middleware.py)
- [é™æµç®—æ³•è¯¦è§£](./rate_limiter.py)
- [ç›‘æ§ç³»ç»Ÿæ¶æ„](./security_monitor.py)
- [é›†æˆä½¿ç”¨ç¤ºä¾‹](./security_integration.py)

## ğŸ†˜ æŠ€æœ¯æ”¯æŒ

### è·å–å¸®åŠ©
1. **æŸ¥çœ‹æ—¥å¿—**: æ£€æŸ¥åº”ç”¨æ—¥å¿—ä¸­çš„å®‰å…¨ç›¸å…³ä¿¡æ¯
2. **è¿è¡Œè¯Šæ–­**: ä½¿ç”¨å†…ç½®çš„çŠ¶æ€æ£€æŸ¥æ¥å£
3. **é…ç½®éªŒè¯**: æ£€æŸ¥å®‰å…¨é…ç½®æ˜¯å¦æ­£ç¡®
4. **æ€§èƒ½åˆ†æ**: ç›‘æ§å®‰å…¨ç³»ç»Ÿçš„æ€§èƒ½æŒ‡æ ‡

### è”ç³»æ–¹å¼
- é¡¹ç›®æ–‡æ¡£: `backend/security/README.md`
- ä½¿ç”¨ç¤ºä¾‹: `backend/security/security_integration.py`
- é…ç½®å‚è€ƒ: `backend/security/security_config.py`

---

**RedFire ä¼ä¸šçº§å®‰å…¨é˜²æŠ¤ç³»ç»Ÿ** - ä¸ºæ‚¨çš„åº”ç”¨æä¾›å…¨æ–¹ä½çš„å®‰å…¨ä¿æŠ¤ ğŸ›¡ï¸
