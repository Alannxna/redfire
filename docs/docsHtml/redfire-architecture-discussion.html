<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RedFireç³»ç»Ÿæ¶æ„è®¨è®ºæ–‡æ¡£</title>
    <!-- å¤šä¸ªCDNæºç¡®ä¿åŠ è½½æˆåŠŸ -->
    <script src="https://unpkg.com/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <script>
        // å¤‡ç”¨CDNåŠ è½½
        if (typeof mermaid === 'undefined') {
            const script = document.createElement('script');
            script.src = 'https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js';
            document.head.appendChild(script);
        }
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: white;
            margin-top: 20px;
            margin-bottom: 20px;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px;
            margin: -20px -20px 40px -20px;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .header .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .meta-info {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            border-left: 4px solid #667eea;
        }
        
        .meta-info h3 {
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .section {
            margin-bottom: 40px;
        }
        
        .section h2 {
            color: #667eea;
            font-size: 2rem;
            margin-bottom: 20px;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }
        
        .section h3 {
            color: #764ba2;
            font-size: 1.5rem;
            margin-bottom: 15px;
            margin-top: 25px;
        }
        
        .section h4 {
            color: #495057;
            font-size: 1.2rem;
            margin-bottom: 10px;
            margin-top: 20px;
        }
        
        .architecture-layer {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 20px;
            margin: 15px 0;
            border-radius: 8px;
            border-left: 5px solid #667eea;
        }
        
        .architecture-layer h4 {
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .service-card {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .service-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .service-card h5 {
            color: #667eea;
            font-size: 1.1rem;
            margin-bottom: 10px;
        }
        
        .service-card .port {
            background: #667eea;
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.9rem;
            font-weight: bold;
        }
        
        .tech-stack {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .tech-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #28a745;
        }
        
        .tech-item h5 {
            color: #28a745;
            margin-bottom: 5px;
        }
        
        .diagram-container {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }
        
        .diagram-title {
            color: #667eea;
            font-size: 1.3rem;
            margin-bottom: 15px;
            font-weight: bold;
        }
        
        .mermaid {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin: 10px 0;
        }
        
        .highlight-box {
            background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 5px solid #e17055;
        }
        
        .highlight-box h4 {
            color: #d63031;
            margin-bottom: 10px;
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .feature-item {
            background: #e8f5e8;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 2px solid #28a745;
        }
        
        .feature-item h5 {
            color: #28a745;
            margin-bottom: 5px;
        }
        
        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            margin: 15px 0;
        }
        
        .toc {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }
        
        .toc h3 {
            color: #667eea;
            margin-bottom: 15px;
        }
        
        .toc ul {
            list-style: none;
            padding-left: 0;
        }
        
        .toc li {
            margin-bottom: 8px;
        }
        
        .toc a {
            color: #495057;
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 4px;
            transition: background-color 0.2s ease;
        }
        
        .toc a:hover {
            background-color: #667eea;
            color: white;
        }
        
        .footer {
            text-align: center;
            margin-top: 50px;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 8px;
            color: #6c757d;
        }
        
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                padding: 15px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .tech-stack {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš€ RedFireé‡åŒ–äº¤æ˜“ç³»ç»Ÿ</h1>
            <p class="subtitle">ç³»ç»Ÿæ¶æ„è¯¦è§£ä¸æŠ€æœ¯è®¨è®ºæ–‡æ¡£</p>
        </div>

        <div class="meta-info">
            <h3>ğŸ“‹ æ–‡æ¡£ä¿¡æ¯</h3>
            <p><strong>ç”Ÿæˆæ—¶é—´:</strong> 2024å¹´12æœˆ19æ—¥</p>
            <p><strong>è®¨è®ºä¸»é¢˜:</strong> RedFireç³»ç»Ÿæ•´ä½“æ¶æ„åˆ†æ</p>
            <p><strong>æ•°æ®åº“ç¡®è®¤:</strong> MySQLæ•°æ®åº“é…ç½®</p>
            <p><strong>æ¶µç›–å†…å®¹:</strong> å‰ç«¯æ¶æ„ã€åç«¯å¾®æœåŠ¡ã€æ•°æ®åº“é…ç½®ã€æŠ€æœ¯æ ˆé€‰å‹</p>
        </div>

        <div class="toc">
            <h3>ğŸ“š ç›®å½•å¯¼èˆª</h3>
            <ul>
                <li><a href="#overview">ç³»ç»Ÿæ¦‚è§ˆ</a></li>
                <li><a href="#architecture-layers">æ¶æ„å±‚æ¬¡</a></li>
                <li><a href="#frontend-arch">å‰ç«¯æ¶æ„</a></li>
                <li><a href="#backend-arch">åç«¯æ¶æ„</a></li>
                <li><a href="#database-config">æ•°æ®åº“é…ç½®</a></li>
                <li><a href="#diagrams">æ¶æ„å›¾è¡¨</a></li>
                <li><a href="#tech-stack">æŠ€æœ¯æ ˆè¯¦è§£</a></li>
                <li><a href="#features">æ ¸å¿ƒç‰¹æ€§</a></li>
            </ul>
        </div>

        <div class="section" id="overview">
            <h2>ğŸŒŸ ç³»ç»Ÿæ¦‚è§ˆ</h2>
            <p>RedFireæ˜¯ä¸€ä¸ªåŸºäº<strong>å¾®æœåŠ¡æ¶æ„</strong>çš„é‡åŒ–äº¤æ˜“å¹³å°ï¼Œé‡‡ç”¨<strong>DDDï¼ˆé¢†åŸŸé©±åŠ¨è®¾è®¡ï¼‰</strong>æ€æƒ³ï¼Œæ”¯æŒå¤šç§äº¤æ˜“æ¥å£ï¼Œå…·å¤‡å®Œæ•´çš„é£é™©ç®¡ç†ä½“ç³»ã€‚</p>
            
            <div class="highlight-box">
                <h4>ğŸ¯ æ ¸å¿ƒç‰¹æ€§</h4>
                <ul>
                    <li><strong>å¾®æœåŠ¡æ¶æ„:</strong> æœåŠ¡ç‹¬ç«‹éƒ¨ç½²ï¼Œä¾¿äºæ‰©å±•</li>
                    <li><strong>äº‹ä»¶é©±åŠ¨:</strong> å¼‚æ­¥å¤„ç†ï¼Œæé«˜æ€§èƒ½</li>
                    <li><strong>DDDè®¾è®¡:</strong> æ¸…æ™°çš„ä¸šåŠ¡è¾¹ç•Œ</li>
                    <li><strong>é«˜å¯ç”¨æ€§:</strong> æœåŠ¡å†—ä½™å’Œæ•…éšœè½¬ç§»</li>
                </ul>
            </div>
        </div>

        <div class="section" id="architecture-layers">
            <h2>ğŸ—ï¸ æ¶æ„å±‚æ¬¡</h2>
            
            <div class="architecture-layer">
                <h4>ğŸŒ ç”¨æˆ·å±‚ (User Layer)</h4>
                <p>Webç”¨æˆ· + ç§»åŠ¨ç”¨æˆ· + ä¸“ä¸šäº¤æ˜“å‘˜ + ç³»ç»Ÿç®¡ç†å‘˜</p>
            </div>
            
            <div class="architecture-layer">
                <h4>ğŸ¨ å‰ç«¯å±‚ (Frontend Layer)</h4>
                <p>Webåº”ç”¨ + ç§»åŠ¨åº”ç”¨ + ç®¡ç†åå° + ä¸“ä¸šäº¤æ˜“ç•Œé¢</p>
            </div>
            
            <div class="architecture-layer">
                <h4>ğŸ”Œ APIç½‘å…³å±‚ (Gateway Layer)</h4>
                <p>FastAPIç½‘å…³ + WebSocketæœåŠ¡ + è®¤è¯æˆæƒ + è´Ÿè½½å‡è¡¡</p>
            </div>
            
            <div class="architecture-layer">
                <h4>âš™ï¸ åç«¯å±‚ (Backend Layer)</h4>
                <p>ä¸»äº¤æ˜“å¼•æ“ + äº‹ä»¶å¼•æ“ + ç­–ç•¥å¼•æ“ + é£é™©å¼•æ“ + æ•°æ®å¼•æ“</p>
            </div>
            
            <div class="architecture-layer">
                <h4>ğŸ—„ï¸ æ•°æ®å±‚ (Data Layer)</h4>
                <p>MySQL + Redis + InfluxDB + MongoDB</p>
            </div>
            
            <div class="architecture-layer">
                <h4>ğŸŒ å¤–éƒ¨æ¥å£å±‚ (External Layer)</h4>
                <p>CTPæ¥å£ + IBæ¥å£ + OKEXæ¥å£ + å¸‚åœºæ•°æ®æº</p>
            </div>
        </div>

        <div class="section" id="frontend-arch">
            <h2>ğŸ¨ å‰ç«¯æ¶æ„</h2>
            
            <h3>ğŸ“¦ Monorepoç»“æ„</h3>
            <div class="code-block">
frontend/
â”œâ”€â”€ ğŸ“‚ apps/                    # åº”ç”¨å±‚
â”‚   â””â”€â”€ web-app/               # Webä¸»åº”ç”¨ (React + TypeScript)
â”œâ”€â”€ ğŸ“‚ packages/               # å…±äº«åŒ…
â”‚   â”œâ”€â”€ ui-components/         # UIç»„ä»¶åº“
â”‚   â”œâ”€â”€ business-components/   # ä¸šåŠ¡ç»„ä»¶åº“
â”‚   â”œâ”€â”€ shared-types/          # å…±äº«ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ api-client/            # APIå®¢æˆ·ç«¯
â”‚   â””â”€â”€ theme-system/          # ä¸»é¢˜ç³»ç»Ÿ
â”œâ”€â”€ ğŸ“‚ shared/                 # å…±äº«èµ„æº
â”œâ”€â”€ ğŸ“‚ tools/                  # å¼€å‘å·¥å…·
â””â”€â”€ ğŸ“‚ tests/                  # æµ‹è¯•ä»£ç 
            </div>

            <h3>ğŸ”§ å‰ç«¯æœåŠ¡ç»„æˆ</h3>
            <div class="service-card">
                <h5>Webä¸»åº”ç”¨ <span class="port">:3000</span></h5>
                <p><strong>åŠŸèƒ½:</strong> ä¸»è¦äº¤æ˜“ç•Œé¢ã€ç”¨æˆ·ç®¡ç†ã€ç­–ç•¥ç®¡ç†</p>
                <p><strong>æŠ€æœ¯:</strong> React + TypeScript + Ant Design</p>
            </div>
            
            <div class="service-card">
                <h5>UIç»„ä»¶åº“</h5>
                <p><strong>åŠŸèƒ½:</strong> å¯å¤ç”¨çš„UIç»„ä»¶</p>
                <p><strong>æŠ€æœ¯:</strong> React + TypeScript + Styled Components</p>
            </div>
            
            <div class="service-card">
                <h5>ä¸šåŠ¡ç»„ä»¶åº“</h5>
                <p><strong>åŠŸèƒ½:</strong> äº¤æ˜“ç›¸å…³ä¸šåŠ¡ç»„ä»¶</p>
                <p><strong>æŠ€æœ¯:</strong> React + TypeScript + ä¸šåŠ¡é€»è¾‘</p>
            </div>
        </div>

        <div class="section" id="backend-arch">
            <h2>âš™ï¸ åç«¯æ¶æ„</h2>
            
            <h3>ğŸ—ï¸ å¾®æœåŠ¡æ¶æ„</h3>
            <p>RedFireåç«¯é‡‡ç”¨<strong>é›†æˆæ ¸å¿ƒ + è¾…åŠ©å¾®æœåŠ¡</strong>çš„æ¶æ„æ¨¡å¼ï¼š</p>
            
            <div class="service-card">
                <h5>ğŸ”¥ VnPyé›†æˆæ ¸å¿ƒæœåŠ¡ <span class="port">:8006</span></h5>
                <p><strong>åŠŸèƒ½:</strong> VnPyå¼•æ“ç®¡ç†ã€äº‹ä»¶å¤„ç†ã€ç½‘å…³è¿æ¥ã€å¸‚åœºæ•°æ®ã€ç­–ç•¥ç®¡ç†ã€Redisæ¶ˆæ¯é˜Ÿåˆ—</p>
                <p><strong>ä½œç”¨:</strong> ç³»ç»Ÿçš„æ ¸å¿ƒäº¤æ˜“å¼•æ“ï¼Œè´Ÿè´£ç­–ç•¥æ‰§è¡Œã€è®¢å•ç®¡ç†ã€å®æ—¶æ•°æ®å¤„ç†</p>
            </div>
            
            <div class="service-card">
                <h5>ğŸ‘¤ ç”¨æˆ·äº¤æ˜“æœåŠ¡ <span class="port">:8001</span></h5>
                <p><strong>åŠŸèƒ½:</strong> ç”¨æˆ·è®¤è¯å’Œæˆæƒã€è´¦æˆ·ç®¡ç†ã€è®¢å•äº¤æ˜“ã€é£é™©æ§åˆ¶</p>
                <p><strong>ä½œç”¨:</strong> å¤„ç†ç”¨æˆ·ç›¸å…³çš„æ‰€æœ‰ä¸šåŠ¡é€»è¾‘ï¼ŒåŒ…æ‹¬è®¤è¯ã€äº¤æ˜“ã€é£æ§</p>
            </div>
            
            <div class="service-card">
                <h5>ğŸ“Š ç­–ç•¥æ•°æ®æœåŠ¡ <span class="port">:8002</span></h5>
                <p><strong>åŠŸèƒ½:</strong> ç­–ç•¥ç®¡ç†ã€å†å²æ•°æ®ç®¡ç†ã€å›æµ‹åˆ†æã€æŠ€æœ¯æŒ‡æ ‡è®¡ç®—</p>
                <p><strong>ä½œç”¨:</strong> è´Ÿè´£ç­–ç•¥çš„åˆ›å»ºã€ç®¡ç†ã€å›æµ‹ä»¥åŠå†å²æ•°æ®çš„å¤„ç†</p>
            </div>
            
            <div class="service-card">
                <h5>ğŸŒ ç½‘å…³é€‚é…æœåŠ¡ <span class="port">:8004</span></h5>
                <p><strong>åŠŸèƒ½:</strong> CTPæ¥å£é€‚é…ã€åè®®æ ¼å¼è½¬æ¢ã€è®¢å•è·¯ç”±è½¬å‘</p>
                <p><strong>ä½œç”¨:</strong> è´Ÿè´£ä¸å¤–éƒ¨äº¤æ˜“æ¥å£çš„è¿æ¥å’Œåè®®è½¬æ¢</p>
            </div>
            
            <div class="service-card">
                <h5>ğŸ“± ç›‘æ§é€šçŸ¥æœåŠ¡ <span class="port">:8005</span></h5>
                <p><strong>åŠŸèƒ½:</strong> ç³»ç»Ÿæ€§èƒ½ç›‘æ§ã€æœåŠ¡å¥åº·æ£€æŸ¥ã€å‘Šè­¦è§„åˆ™ç®¡ç†</p>
                <p><strong>ä½œç”¨:</strong> è´Ÿè´£ç³»ç»Ÿçš„ç›‘æ§ã€å‘Šè­¦å’Œé€šçŸ¥åŠŸèƒ½</p>
            </div>

            <h3>ğŸ›ï¸ Clean Architectureåˆ†å±‚</h3>
            <div class="code-block">
# æ¥å£å±‚ (Interface Layer)
interfaces/
â”œâ”€â”€ rest/                    # REST APIæ¥å£
â”œâ”€â”€ websocket/              # WebSocketæ¥å£
â””â”€â”€ grpc/                   # gRPCæ¥å£

# åº”ç”¨å±‚ (Application Layer)  
application/
â”œâ”€â”€ services/               # åº”ç”¨æœåŠ¡
â”œâ”€â”€ commands/               # å‘½ä»¤å¤„ç†å™¨
â”œâ”€â”€ queries/                # æŸ¥è¯¢å¤„ç†å™¨
â””â”€â”€ events/                 # äº‹ä»¶å¤„ç†å™¨

# é¢†åŸŸå±‚ (Domain Layer)
domain/
â”œâ”€â”€ trading/                # äº¤æ˜“é¢†åŸŸ
â”œâ”€â”€ strategy/               # ç­–ç•¥é¢†åŸŸ
â”œâ”€â”€ user/                   # ç”¨æˆ·é¢†åŸŸ
â””â”€â”€ data/                   # æ•°æ®é¢†åŸŸ

# åŸºç¡€è®¾æ–½å±‚ (Infrastructure Layer)
infrastructure/
â”œâ”€â”€ database/               # æ•°æ®åº“è®¿é—®
â”œâ”€â”€ cache/                  # ç¼“å­˜ç®¡ç†
â”œâ”€â”€ messaging/              # æ¶ˆæ¯é˜Ÿåˆ—
â””â”€â”€ external/               # å¤–éƒ¨æœåŠ¡
            </div>
        </div>

        <div class="section" id="database-config">
            <h2>ğŸ—„ï¸ æ•°æ®åº“é…ç½®ç¡®è®¤</h2>
            
            <div class="highlight-box">
                <h4>âœ… ç¡®è®¤ç»“æœ</h4>
                <p>æ ¹æ®é…ç½®æ–‡ä»¶æ£€æŸ¥ï¼ŒRedFireç³»ç»Ÿ<strong>ç¡®å®ä½¿ç”¨çš„æ˜¯MySQLæ•°æ®åº“</strong>ã€‚</p>
            </div>

            <h3>ğŸ“‹ MySQLé…ç½®ä¿¡æ¯</h3>
            <div class="code-block">
# æ•°æ®åº“ç±»å‹
DATABASE_TYPE = "mysql"
DB_TYPE=mysql

# MySQLè¿æ¥é…ç½®
DB_HOST=localhost
DB_PORT=3306
DB_USER=root
DB_PASSWORD=root
DB_NAME=vnpy

# è¿æ¥å­—ç¬¦ä¸²æ ¼å¼
mysql+pymysql://{user}:{password}@{host}:{port}/{database}?charset=utf8mb4
            </div>

            <h3>ğŸ“¦ ç›¸å…³ä¾èµ–</h3>
            <div class="code-block">
# requirements.txt ä¸­çš„MySQLç›¸å…³ä¾èµ–
sqlalchemy>=2.0.0        # ORMæ”¯æŒ
pymysql>=1.1.0           # MySQLè¿æ¥å™¨
            </div>

            <h3>ğŸ”§ è¿æ¥æ± é…ç½®</h3>
            <div class="code-block">
# æ•°æ®åº“è¿æ¥æ± å‚æ•°
DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600
            </div>
        </div>

        <div class="section" id="diagrams">
            <h2>ğŸ“Š æ¶æ„å›¾è¡¨</h2>
            
            <div class="diagram-container">
                <div class="diagram-title">ğŸ—ï¸ ç³»ç»Ÿæ•´ä½“æ¶æ„å›¾</div>
                <div class="mermaid">
graph TB
    User["ğŸŒ ç”¨æˆ·å±‚<br/>Webç”¨æˆ· + ç§»åŠ¨ç”¨æˆ· + ä¸“ä¸šäº¤æ˜“å‘˜"] --> Frontend["ğŸ¨ å‰ç«¯å±‚<br/>React + TypeScript + Ant Design"]
    Frontend --> Gateway["ğŸ”Œ APIç½‘å…³å±‚<br/>FastAPI + WebSocket + è®¤è¯æˆæƒ"]
    Gateway --> Backend["âš™ï¸ åç«¯å±‚<br/>å¾®æœåŠ¡æ¶æ„ + äº‹ä»¶é©±åŠ¨"]
    Backend --> Data["ğŸ—„ï¸ æ•°æ®å±‚<br/>MySQL + Redis + InfluxDB"]
    Backend --> External["ğŸŒ å¤–éƒ¨æ¥å£å±‚<br/>CTP + IB + OKEX"]
    
    subgraph "Frontend Architecture"
        WebApp["Webåº”ç”¨<br/>:3000"]
        UILib["UIç»„ä»¶åº“"]
        BizLib["ä¸šåŠ¡ç»„ä»¶åº“"] 
        APIClient["APIå®¢æˆ·ç«¯"]
    end
    
    subgraph "Backend Microservices"
        VnpyCore["VnPyæ ¸å¿ƒæœåŠ¡<br/>:8006<br/>ğŸ”¥ ä¸»å¼•æ“"]
        UserService["ç”¨æˆ·äº¤æ˜“æœåŠ¡<br/>:8001<br/>ğŸ‘¤ è®¤è¯é£æ§"]
        DataService["ç­–ç•¥æ•°æ®æœåŠ¡<br/>:8002<br/>ğŸ“Š æ•°æ®å›æµ‹"]
        GatewayService["ç½‘å…³é€‚é…æœåŠ¡<br/>:8004<br/>ğŸŒ CTPè·¯ç”±"]
        MonitorService["ç›‘æ§é€šçŸ¥æœåŠ¡<br/>:8005<br/>ğŸ“± ç›‘æ§å‘Šè­¦"]
    end
    
    subgraph "Data Storage"
        MySQL["MySQL<br/>ä¸»æ•°æ®åº“"]
        Redis["Redis<br/>ç¼“å­˜é˜Ÿåˆ—"]
        InfluxDB["InfluxDB<br/>æ—¶åºæ•°æ®"]
        MongoDB["MongoDB<br/>æ–‡æ¡£å­˜å‚¨"]
    end
    
    Frontend --> WebApp
    Frontend --> UILib
    Frontend --> BizLib
    Frontend --> APIClient
    
    Backend --> VnpyCore
    Backend --> UserService
    Backend --> DataService
    Backend --> GatewayService
    Backend --> MonitorService
    
    Data --> MySQL
    Data --> Redis
    Data --> InfluxDB
    Data --> MongoDB
    
    VnpyCore -.-> UserService
    VnpyCore -.-> DataService
    VnpyCore -.-> GatewayService
    VnpyCore -.-> MonitorService
                </div>
            </div>

            <div class="diagram-container">
                <div class="diagram-title">ğŸ”„ æ•°æ®æµå‘å›¾</div>
                <div class="mermaid">
graph LR
    subgraph "æ•°æ®æµå‘å›¾"
        A["ç”¨æˆ·æ“ä½œ"] --> B["å‰ç«¯ç•Œé¢"]
        B --> C["APIç½‘å…³"]
        C --> D["åç«¯æœåŠ¡"]
        D --> E["æ•°æ®å­˜å‚¨"]
        
        F["å¸‚åœºæ•°æ®"] --> G["æ•°æ®å¼•æ“"]
        G --> H["äº‹ä»¶å¼•æ“"]
        H --> I["ç­–ç•¥å¼•æ“"]
        I --> J["äº¤æ˜“æ‰§è¡Œ"]
        
        K["å¤–éƒ¨æ¥å£"] --> L["ç½‘å…³æ¥å£"]
        L --> M["äº¤æ˜“å¼•æ“"]
        M --> N["é£é™©æ§åˆ¶"]
        N --> O["ç»“æœåé¦ˆ"]
    end
    
    subgraph "å®æ—¶æ•°æ®æµ"
        P["WebSocket"] --> Q["å®æ—¶æ¨é€"]
        Q --> R["å‰ç«¯æ›´æ–°"]
        R --> S["ç”¨æˆ·ç•Œé¢"]
        S --> T["äº¤æ˜“åé¦ˆ"]
    end
                </div>
            </div>

            <div class="diagram-container">
                <div class="diagram-title">ğŸ›ï¸ Clean Architectureåˆ†å±‚æ¶æ„</div>
                <div class="mermaid">
graph TB
    subgraph "Clean Architecture - åˆ†å±‚æ¶æ„"
        Interface["ğŸ”Œ æ¥å£å±‚<br/>REST API + WebSocket + gRPC"]
        Application["ğŸ“± åº”ç”¨å±‚<br/>æœåŠ¡ + å‘½ä»¤ + æŸ¥è¯¢ + äº‹ä»¶"]
        Domain["ğŸ›ï¸ é¢†åŸŸå±‚<br/>äº¤æ˜“ + ç­–ç•¥ + ç”¨æˆ· + æ•°æ®"]
        Infrastructure["ğŸ—ï¸ åŸºç¡€è®¾æ–½å±‚<br/>æ•°æ®åº“ + ç¼“å­˜ + æ¶ˆæ¯ + ç›‘æ§"]
    end
    
    Interface --> Application
    Application --> Domain
    Application --> Infrastructure
    Domain --> Infrastructure
    
    subgraph "DDDé¢†åŸŸæ¨¡å‹"
        Trading["äº¤æ˜“é¢†åŸŸ<br/>è®¢å• + æŒä»“ + æˆäº¤"]
        Strategy["ç­–ç•¥é¢†åŸŸ<br/>ç­–ç•¥ + å›æµ‹ + æ‰§è¡Œ"]
        User["ç”¨æˆ·é¢†åŸŸ<br/>è®¤è¯ + æƒé™ + è´¦æˆ·"]
        DataDomain["æ•°æ®é¢†åŸŸ<br/>å¸‚åœº + å†å² + æŒ‡æ ‡"]
        Risk["é£é™©é¢†åŸŸ<br/>é£æ§ + é™é¢ + ç›‘æ§"]
    end
    
    Domain --> Trading
    Domain --> Strategy
    Domain --> User
    Domain --> DataDomain
    Domain --> Risk
                </div>
            </div>
        </div>

        <div class="section" id="tech-stack">
            <h2>ğŸ”§ æŠ€æœ¯æ ˆè¯¦è§£</h2>
            
            <div class="tech-stack">
                <div class="tech-item">
                    <h5>å‰ç«¯æŠ€æœ¯æ ˆ</h5>
                    <ul>
                        <li>React 18 + TypeScript</li>
                        <li>Ant Design</li>
                        <li>Redux Toolkit + Zustand</li>
                        <li>Vite + Turborepo</li>
                    </ul>
                </div>
                
                <div class="tech-item">
                    <h5>åç«¯æŠ€æœ¯æ ˆ</h5>
                    <ul>
                        <li>Python 3.9+</li>
                        <li>FastAPI</li>
                        <li>asyncio + aiohttp</li>
                        <li>SQLAlchemy + PyMySQL</li>
                    </ul>
                </div>
                
                <div class="tech-item">
                    <h5>æ•°æ®åº“æŠ€æœ¯æ ˆ</h5>
                    <ul>
                        <li>MySQL (ä¸»æ•°æ®åº“)</li>
                        <li>Redis (ç¼“å­˜é˜Ÿåˆ—)</li>
                        <li>InfluxDB (æ—¶åºæ•°æ®)</li>
                        <li>MongoDB (æ–‡æ¡£å­˜å‚¨)</li>
                    </ul>
                </div>
                
                <div class="tech-item">
                    <h5>è¿ç»´æŠ€æœ¯æ ˆ</h5>
                    <ul>
                        <li>Docker + Kubernetes</li>
                        <li>Prometheus + Grafana</li>
                        <li>ELK Stack</li>
                        <li>GitHub Actions</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="section" id="features">
            <h2>ğŸŒŸ æ ¸å¿ƒç‰¹æ€§</h2>
            
            <div class="features-grid">
                <div class="feature-item">
                    <h5>âœ… é«˜å¯ç”¨æ€§</h5>
                    <p>å¾®æœåŠ¡æ¶æ„ï¼ŒæœåŠ¡ç‹¬ç«‹éƒ¨ç½²</p>
                </div>
                
                <div class="feature-item">
                    <h5>âš¡ é«˜æ€§èƒ½</h5>
                    <p>å¼‚æ­¥äº‹ä»¶å¤„ç†ï¼ŒRedisç¼“å­˜ä¼˜åŒ–</p>
                </div>
                
                <div class="feature-item">
                    <h5>ğŸ”§ å¯æ‰©å±•æ€§</h5>
                    <p>æ’ä»¶åŒ–æ¶æ„ï¼Œæ°´å¹³æ‰©å±•æ”¯æŒ</p>
                </div>
                
                <div class="feature-item">
                    <h5>ğŸ”’ å®‰å…¨æ€§</h5>
                    <p>å¤šå±‚å®‰å…¨é˜²æŠ¤ï¼Œæ•°æ®åŠ å¯†ä¼ è¾“</p>
                </div>
                
                <div class="feature-item">
                    <h5>ğŸ“Š ç›‘æ§ä½“ç³»</h5>
                    <p>åº”ç”¨æ€§èƒ½ç›‘æ§ï¼Œå®æ—¶å‘Šè­¦é€šçŸ¥</p>
                </div>
                
                <div class="feature-item">
                    <h5>ğŸ—ï¸ DDDè®¾è®¡</h5>
                    <p>é¢†åŸŸé©±åŠ¨è®¾è®¡ï¼Œæ¸…æ™°ä¸šåŠ¡è¾¹ç•Œ</p>
                </div>
            </div>

            <h3>ğŸš€ éƒ¨ç½²æ¶æ„</h3>
            <div class="service-card">
                <h5>ğŸ  å¼€å‘ç¯å¢ƒ</h5>
                <p>å•æœºéƒ¨ç½²ï¼ŒDocker Composeç®¡ç†æœåŠ¡ï¼Œæœ¬åœ°æ•°æ®åº“</p>
            </div>
            
            <div class="service-card">
                <h5>â˜ï¸ ç”Ÿäº§ç¯å¢ƒ</h5>
                <p>Kubernetesé›†ç¾¤éƒ¨ç½²ï¼Œè´Ÿè½½å‡è¡¡ï¼Œæ•°æ®åº“é›†ç¾¤</p>
            </div>
        </div>

        <div class="footer">
            <p>ğŸ“„ æœ¬æ–‡æ¡£ç”±AIåŠ©æ‰‹ç”Ÿæˆï¼ŒåŒ…å«RedFireç³»ç»Ÿæ¶æ„çš„å®Œæ•´è®¨è®ºå†…å®¹</p>
            <p>ğŸ• ç”Ÿæˆæ—¶é—´: 2024å¹´12æœˆ19æ—¥ | ğŸ“ é¡¹ç›®è·¯å¾„: D:\HubGit\redfire</p>
            <p>ğŸ’¡ å¦‚éœ€æ›´æ–°æˆ–è¡¥å……å†…å®¹ï¼Œè¯·è”ç³»å¼€å‘å›¢é˜Ÿ</p>
        </div>
    </div>

    <script>
        // ç­‰å¾…é¡µé¢å®Œå…¨åŠ è½½
        window.addEventListener('load', function() {
            // å¤šæ¬¡å°è¯•åˆå§‹åŒ–
            let attempts = 0;
            const maxAttempts = 5;
            
            function initializeMermaid() {
                attempts++;
                
                if (typeof mermaid !== 'undefined') {
                    try {
                        // ä½¿ç”¨ç¨³å®šçš„é…ç½®
                        mermaid.initialize({
                            startOnLoad: false,
                            theme: 'default',
                            securityLevel: 'loose',
                            themeVariables: {
                                primaryColor: '#667eea',
                                primaryTextColor: '#333333',
                                primaryBorderColor: '#764ba2',
                                lineColor: '#495057'
                            },
                            flowchart: {
                                useMaxWidth: true,
                                htmlLabels: true
                            }
                        });
                        
                        // æ‰‹åŠ¨æ¸²æŸ“
                        mermaid.run();
                        console.log('Mermaid diagrams rendered successfully');
                        
                    } catch (error) {
                        console.error('Mermaid rendering error:', error);
                        if (attempts < maxAttempts) {
                            setTimeout(initializeMermaid, 1000);
                        } else {
                            showFallbackDiagrams();
                        }
                    }
                } else if (attempts < maxAttempts) {
                    // ç­‰å¾…è„šæœ¬åŠ è½½
                    setTimeout(initializeMermaid, 500);
                } else {
                    console.error('Mermaid library failed to load after multiple attempts');
                    showFallbackDiagrams();
                }
            }
            
            // æ˜¾ç¤ºå¤‡ç”¨å›¾è¡¨
            function showFallbackDiagrams() {
                document.querySelectorAll('.mermaid').forEach(function(element, index) {
                    const fallbackContent = [
                        // ç¬¬ä¸€ä¸ªå›¾è¡¨çš„å¤‡ç”¨å†…å®¹
                        `<div style="padding: 30px; background: #e8f5e8; border-radius: 8px; text-align: left; border: 2px solid #28a745;">
                            <h4 style="color: #155724; margin-bottom: 20px; text-align: center;">ğŸ—ï¸ RedFireç³»ç»Ÿæ•´ä½“æ¶æ„</h4>
                            <div style="font-family: monospace; line-height: 1.8; color: #155724;">
                                <strong>ğŸŒ ç”¨æˆ·å±‚:</strong> Webç”¨æˆ· + ç§»åŠ¨ç”¨æˆ· + ä¸“ä¸šäº¤æ˜“å‘˜<br>
                                <strong>ğŸ¨ å‰ç«¯å±‚:</strong> React + TypeScript + Ant Design (:3000)<br>
                                <strong>ğŸ”Œ ç½‘å…³å±‚:</strong> FastAPI + WebSocket + è®¤è¯æˆæƒ<br>
                                <strong>âš™ï¸ åç«¯å±‚:</strong> å¾®æœåŠ¡æ¶æ„ + äº‹ä»¶é©±åŠ¨<br>
                                &nbsp;&nbsp;â€¢ VnPyæ ¸å¿ƒæœåŠ¡ (:8006) - ä¸»äº¤æ˜“å¼•æ“<br>
                                &nbsp;&nbsp;â€¢ ç”¨æˆ·äº¤æ˜“æœåŠ¡ (:8001) - è®¤è¯é£æ§<br>
                                &nbsp;&nbsp;â€¢ ç­–ç•¥æ•°æ®æœåŠ¡ (:8002) - æ•°æ®å›æµ‹<br>
                                &nbsp;&nbsp;â€¢ ç½‘å…³é€‚é…æœåŠ¡ (:8004) - CTPæ¥å£<br>
                                &nbsp;&nbsp;â€¢ ç›‘æ§é€šçŸ¥æœåŠ¡ (:8005) - ç³»ç»Ÿç›‘æ§<br>
                                <strong>ğŸ—„ï¸ æ•°æ®å±‚:</strong> MySQL + Redis + InfluxDB + MongoDB<br>
                                <strong>ğŸŒ å¤–éƒ¨å±‚:</strong> CTP + IB + OKEX + å¸‚åœºæ•°æ®æº
                            </div>
                        </div>`,
                        
                        // ç¬¬äºŒä¸ªå›¾è¡¨çš„å¤‡ç”¨å†…å®¹
                        `<div style="padding: 30px; background: #e3f2fd; border-radius: 8px; text-align: left; border: 2px solid #1976d2;">
                            <h4 style="color: #0d47a1; margin-bottom: 20px; text-align: center;">ğŸ”„ æ•°æ®æµå‘ç¤ºæ„</h4>
                            <div style="font-family: monospace; line-height: 1.8; color: #0d47a1;">
                                <strong>ç”¨æˆ·æ“ä½œæµ:</strong><br>
                                ç”¨æˆ·æ“ä½œ â†’ å‰ç«¯ç•Œé¢ â†’ APIç½‘å…³ â†’ åç«¯æœåŠ¡ â†’ æ•°æ®å­˜å‚¨<br><br>
                                <strong>å¸‚åœºæ•°æ®æµ:</strong><br>
                                å¸‚åœºæ•°æ® â†’ æ•°æ®å¼•æ“ â†’ äº‹ä»¶å¼•æ“ â†’ ç­–ç•¥å¼•æ“ â†’ äº¤æ˜“æ‰§è¡Œ<br><br>
                                <strong>å¤–éƒ¨æ¥å£æµ:</strong><br>
                                å¤–éƒ¨æ¥å£ â†’ ç½‘å…³æ¥å£ â†’ äº¤æ˜“å¼•æ“ â†’ é£é™©æ§åˆ¶ â†’ ç»“æœåé¦ˆ<br><br>
                                <strong>å®æ—¶æ¨é€æµ:</strong><br>
                                WebSocket â†’ å®æ—¶æ¨é€ â†’ å‰ç«¯æ›´æ–° â†’ ç”¨æˆ·ç•Œé¢
                            </div>
                        </div>`,
                        
                        // ç¬¬ä¸‰ä¸ªå›¾è¡¨çš„å¤‡ç”¨å†…å®¹
                        `<div style="padding: 30px; background: #f3e5f5; border-radius: 8px; text-align: left; border: 2px solid #7b1fa2;">
                            <h4 style="color: #4a148c; margin-bottom: 20px; text-align: center;">ğŸ›ï¸ Clean Architectureåˆ†å±‚</h4>
                            <div style="font-family: monospace; line-height: 1.8; color: #4a148c;">
                                <strong>ğŸ”Œ æ¥å£å±‚ (Interface Layer):</strong><br>
                                &nbsp;&nbsp;REST API + WebSocket + gRPC<br><br>
                                <strong>ğŸ“± åº”ç”¨å±‚ (Application Layer):</strong><br>
                                &nbsp;&nbsp;æœåŠ¡ + å‘½ä»¤ + æŸ¥è¯¢ + äº‹ä»¶å¤„ç†å™¨<br><br>
                                <strong>ğŸ›ï¸ é¢†åŸŸå±‚ (Domain Layer):</strong><br>
                                &nbsp;&nbsp;äº¤æ˜“é¢†åŸŸ + ç­–ç•¥é¢†åŸŸ + ç”¨æˆ·é¢†åŸŸ + æ•°æ®é¢†åŸŸ<br><br>
                                <strong>ğŸ—ï¸ åŸºç¡€è®¾æ–½å±‚ (Infrastructure Layer):</strong><br>
                                &nbsp;&nbsp;æ•°æ®åº“ + ç¼“å­˜ + æ¶ˆæ¯é˜Ÿåˆ— + å¤–éƒ¨æœåŠ¡
                            </div>
                        </div>`
                    ];
                    
                    element.innerHTML = fallbackContent[index] || fallbackContent[0];
                });
            }
            
            // å¼€å§‹åˆå§‹åŒ–
            setTimeout(initializeMermaid, 500);
        });

        // å¹³æ»‘æ»šåŠ¨
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // æ·»åŠ é¡µé¢åŠ è½½åŠ¨ç”»
        window.addEventListener('load', function() {
            document.body.style.opacity = '0';
            document.body.style.transition = 'opacity 0.5s ease-in-out';
            setTimeout(() => {
                document.body.style.opacity = '1';
            }, 100);
        });
    </script>
</body>
</html>
